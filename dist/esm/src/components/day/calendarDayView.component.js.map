{"version":3,"file":"calendarDayView.component.js","sourceRoot":"","sources":["../../../../../src/components/day/calendarDayView.component.ts"],"names":[],"mappings":"OAAO,EACL,SAAS,EACT,uBAAuB,EACvB,KAAK,EAEL,MAAM,EACN,YAAY,EACZ,iBAAiB,EACjB,SAAS,EACT,MAAM,EACP,MAAM,eAAe;OACf,EAAC,UAAU,EAAE,kBAAkB,EAAsC,MAAM,gBAAgB;AAIlG,IAAM,cAAc,GAAW,EAAE,CAAC;AAGlC;IAyEE,yBAAoB,GAAsB,EAAG,MAAc;QAAvC,QAAG,GAAH,GAAG,CAAmB;QAlE1C;;WAEG;QACF,WAAM,GAAoB,EAAE,CAAC;QAE9B;;WAEG;QACF,iBAAY,GAAW,CAAC,CAAC;QAE1B;;WAEG;QACF,iBAAY,GAAW,CAAC,CAAC;QAE1B;;WAEG;QACF,mBAAc,GAAW,CAAC,CAAC;QAE5B;;WAEG;QACF,eAAU,GAAW,EAAE,CAAC;QAEzB;;WAEG;QACF,iBAAY,GAAW,EAAE,CAAC;QAE3B;;WAEG;QACF,eAAU,GAAW,GAAG,CAAC;QAkB1B;;WAEG;QACF,iBAAY,GAAyC,IAAI,YAAY,EAA0B,CAAC;QAEjG;;WAEG;QACF,uBAAkB,GAA+B,IAAI,YAAY,EAAgB,CAAC;QAEnF,UAAK,GAAkB,EAAE,CAAC;QAE1B,UAAK,GAAW,CAAC,CAAC;QAIhB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACvB,CAAC;IAED,kCAAQ,GAAR;QAAA,iBAOC;QANC,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YACjB,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;gBAChD,KAAI,CAAC,UAAU,EAAE,CAAC;gBAClB,KAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;YAC1B,CAAC,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAED,qCAAW,GAAX;QACE,EAAE,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;QACzC,CAAC;IACH,CAAC;IAED,qCAAW,GAAX,UAAY,OAAY;QAEtB,EAAE,CAAC,CACD,OAAO,CAAC,QAAQ;YAChB,OAAO,CAAC,YAAY;YACpB,OAAO,CAAC,cAAc;YACtB,OAAO,CAAC,UAAU;YAClB,OAAO,CAAC,YACV,CAAC,CAAC,CAAC;YACD,IAAI,CAAC,eAAe,EAAE,CAAC;QACzB,CAAC;QAED,EAAE,CAAC,CACD,OAAO,CAAC,QAAQ;YAChB,OAAO,CAAC,MAAM;YACd,OAAO,CAAC,YAAY;YACpB,OAAO,CAAC,cAAc;YACtB,OAAO,CAAC,UAAU;YAClB,OAAO,CAAC,YAAY;YACpB,OAAO,CAAC,UACV,CAAC,CAAC,CAAC;YACD,IAAI,CAAC,WAAW,EAAE,CAAC;QACrB,CAAC;IAEH,CAAC;IAEO,yCAAe,GAAvB;QAAA,iBAkBC;QAjBC,IAAI,CAAC,KAAK,GAAG,kBAAkB,CAAC;YAC9B,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,QAAQ,EAAE;gBACR,IAAI,EAAE,IAAI,CAAC,YAAY;gBACvB,MAAM,EAAE,IAAI,CAAC,cAAc;aAC5B;YACD,MAAM,EAAE;gBACN,IAAI,EAAE,IAAI,CAAC,UAAU;gBACrB,MAAM,EAAE,IAAI,CAAC,YAAY;aAC1B;SACF,CAAC,CAAC;QACH,EAAE,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAA,IAAI;gBACrB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,OAAO,IAAI,OAAA,KAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAjC,CAAiC,CAAC,CAAC;YACtE,CAAC,CAAC,CAAC;QACL,CAAC;IACH,CAAC;IAEO,qCAAW,GAAnB;QACE,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC;YACrB,MAAM,EAAE,IAAI,CAAC,MAAM;YACnB,QAAQ,EAAE,IAAI,CAAC,QAAQ;YACvB,YAAY,EAAE,IAAI,CAAC,YAAY;YAC/B,QAAQ,EAAE;gBACR,IAAI,EAAE,IAAI,CAAC,YAAY;gBACvB,MAAM,EAAE,IAAI,CAAC,cAAc;aAC5B;YACD,MAAM,EAAE;gBACN,IAAI,EAAE,IAAI,CAAC,UAAU;gBACrB,MAAM,EAAE,IAAI,CAAC,YAAY;aAC1B;YACD,UAAU,EAAE,IAAI,CAAC,UAAU;YAC3B,aAAa,EAAE,cAAc;SAC9B,CAAC,CAAC;IACL,CAAC;IAEO,oCAAU,GAAlB;QACE,IAAI,CAAC,eAAe,EAAE,CAAC;QACvB,IAAI,CAAC,WAAW,EAAE,CAAC;IACrB,CAAC;IAEI,0BAAU,GAA0B;QAC3C,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;oBACxB,QAAQ,EAAE,uBAAuB;oBACjC,eAAe,EAAE,uBAAuB,CAAC,MAAM;oBAC/C,QAAQ,EAAE,igCAyBT;iBACF,EAAG,EAAE;KACL,CAAC;IACF,kBAAkB;IACX,8BAAc,GAA6D;QAClF,EAAC,IAAI,EAAE,iBAAiB,GAAG;QAC3B,EAAC,IAAI,EAAE,SAAS,EAAE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,SAAS,EAAG,EAAE,EAAG,EAAC;KACvE,CAAC;IACK,8BAAc,GAA2C;QAChE,UAAU,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAC9B,QAAQ,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAC5B,cAAc,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAClC,cAAc,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAClC,gBAAgB,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QACpC,YAAY,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAChC,cAAc,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAClC,YAAY,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAChC,SAAS,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAC7B,QAAQ,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QAC5B,qBAAqB,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;QACzC,cAAc,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE;QACnC,oBAAoB,EAAE,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE;KACxC,CAAC;IACF,sBAAC;AAAD,CAAC,AArND,IAqNC","sourcesContent":["import {\n  Component,\n  ChangeDetectionStrategy,\n  Input,\n  OnChanges,\n  Output,\n  EventEmitter,\n  ChangeDetectorRef,\n  LOCALE_ID,\n  Inject\n} from '@angular/core';\nimport {getDayView, getDayViewHourGrid, CalendarEvent, DayView, DayViewHour} from 'calendar-utils';\nimport {Subject} from 'rxjs/Subject';\nimport {Subscription} from 'rxjs/Subscription';\n\nconst SEGMENT_HEIGHT: number = 30;\n\n\nexport class CalendarDayView implements OnChanges {\n\n  /**\n   * The current view date\n   */\n   viewDate: Date;\n\n  /**\n   * An array of events to display on view\n   */\n   events: CalendarEvent[] = [];\n\n  /**\n   * The number of segments in an hour. Must be <= 6\n   */\n   hourSegments: number = 2;\n\n  /**\n   * The day start hours in 24 hour time. Must be 0-23\n   */\n   dayStartHour: number = 0;\n\n  /**\n   * The day start minutes. Must be 0-59\n   */\n   dayStartMinute: number = 0;\n\n  /**\n   * The day end hours in 24 hour time. Must be 0-23\n   */\n   dayEndHour: number = 23;\n\n  /**\n   * The day end minutes. Must be 0-59\n   */\n   dayEndMinute: number = 59;\n\n  /**\n   * The width in pixels of each event on the view\n   */\n   eventWidth: number = 150;\n\n  /**\n   * An observable that when emitted on will re-render the current view\n   */\n   refresh: Subject<any>;\n\n  /**\n   * The locale used to format dates\n   */\n   locale: string;\n\n  /**\n   * A function that will be called before each hour segment is called. The first argument will contain the hour segment.\n   * If you add the `cssClass` property to the segment it will add that class to the hour segment in the template\n   */\n   hourSegmentModifier: Function;\n\n  /**\n   * Called when an event title is clicked\n   */\n   eventClicked: EventEmitter<{event: CalendarEvent}> = new EventEmitter<{event: CalendarEvent}>();\n\n  /**\n   * Called when an hour segment is clicked\n   */\n   hourSegmentClicked: EventEmitter<{date: Date}> = new EventEmitter<{date: Date}>();\n\n  hours: DayViewHour[] = [];\n  view: DayView;\n  width: number = 0;\n  refreshSubscription: Subscription;\n\n  constructor(private cdr: ChangeDetectorRef,  locale: string) {\n    this.locale = locale;\n  }\n\n  ngOnInit(): void {\n    if (this.refresh) {\n      this.refreshSubscription = this.refresh.subscribe(() => {\n        this.refreshAll();\n        this.cdr.markForCheck();\n      });\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.refreshSubscription) {\n      this.refreshSubscription.unsubscribe();\n    }\n  }\n\n  ngOnChanges(changes: any): void {\n\n    if (\n      changes.viewDate ||\n      changes.dayStartHour ||\n      changes.dayStartMinute ||\n      changes.dayEndHour ||\n      changes.dayEndMinute\n    ) {\n      this.refreshHourGrid();\n    }\n\n    if (\n      changes.viewDate ||\n      changes.events ||\n      changes.dayStartHour ||\n      changes.dayStartMinute ||\n      changes.dayEndHour ||\n      changes.dayEndMinute ||\n      changes.eventWidth\n    ) {\n      this.refreshView();\n    }\n\n  }\n\n  private refreshHourGrid(): void {\n    this.hours = getDayViewHourGrid({\n      viewDate: this.viewDate,\n      hourSegments: this.hourSegments,\n      dayStart: {\n        hour: this.dayStartHour,\n        minute: this.dayStartMinute\n      },\n      dayEnd: {\n        hour: this.dayEndHour,\n        minute: this.dayEndMinute\n      }\n    });\n    if (this.hourSegmentModifier) {\n      this.hours.forEach(hour => {\n        hour.segments.forEach(segment => this.hourSegmentModifier(segment));\n      });\n    }\n  }\n\n  private refreshView(): void {\n    this.view = getDayView({\n      events: this.events,\n      viewDate: this.viewDate,\n      hourSegments: this.hourSegments,\n      dayStart: {\n        hour: this.dayStartHour,\n        minute: this.dayStartMinute\n      },\n      dayEnd: {\n        hour: this.dayEndHour,\n        minute: this.dayEndMinute\n      },\n      eventWidth: this.eventWidth,\n      segmentHeight: SEGMENT_HEIGHT\n    });\n  }\n\n  private refreshAll(): void {\n    this.refreshHourGrid();\n    this.refreshView();\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  selector: 'mwl-calendar-day-view',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  template: `\n    <div class=\"cal-day-view\">\n      <mwl-calendar-all-day-event\n        *ngFor=\"let event of view.allDayEvents\"\n        [event]=\"event\"\n        (eventClicked)=\"eventClicked.emit({event: event})\">\n      </mwl-calendar-all-day-event>\n      <div class=\"cal-hour-rows\">\n        <div class=\"cal-events\">\n          <mwl-calendar-day-view-event\n            *ngFor=\"let dayEvent of view?.events\"\n            [dayEvent]=\"dayEvent\"\n            (eventClicked)=\"eventClicked.emit({event: dayEvent.event})\">\n          </mwl-calendar-day-view-event>\n        </div>\n        <div class=\"cal-hour\" *ngFor=\"let hour of hours\" [style.minWidth.px]=\"view?.width + 70\">\n          <mwl-calendar-day-view-hour-segment\n            *ngFor=\"let segment of hour.segments\"\n            [segment]=\"segment\"\n            [locale]=\"locale\"\n            (click)=\"hourSegmentClicked.emit({date: segment.date})\">\n          </mwl-calendar-day-view-hour-segment>\n        </div>\n      </div>\n    </div>\n  `\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n{type: ChangeDetectorRef, },\n{type: undefined, decorators: [{ type: Inject, args: [LOCALE_ID, ] }, ]},\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'viewDate': [{ type: Input },],\n'events': [{ type: Input },],\n'hourSegments': [{ type: Input },],\n'dayStartHour': [{ type: Input },],\n'dayStartMinute': [{ type: Input },],\n'dayEndHour': [{ type: Input },],\n'dayEndMinute': [{ type: Input },],\n'eventWidth': [{ type: Input },],\n'refresh': [{ type: Input },],\n'locale': [{ type: Input },],\n'hourSegmentModifier': [{ type: Input },],\n'eventClicked': [{ type: Output },],\n'hourSegmentClicked': [{ type: Output },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}